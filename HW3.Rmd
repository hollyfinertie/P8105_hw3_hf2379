---
title: "HW3 - Visualization"
author: "Holly Finertie"
date: "10/14/2019"
output: github_document
---


# Problem1

```{r}
library(tidyverse)
library(p8105.datasets)
data("instacart")
```


## Description of Instacart Data Set: 

This data set contains `r instacart %>% nrow()` observations and `r instacart %>% ncol()` variables describing order information like time and day order was placed, products ordered, aisle where products are located, and days since last order was placed per user id. For example, the individual with user id 5 ordered `r instacart %>% filter(user_id == 5) %>% summarize(max(add_to_cart_order))` items of which most were from the `r instacart %>% filter(user_id == 5) %>% summarize(max(department))` department. They placed this order `r instacart %>% filter(user_id == 5) %>% summarize(median(days_since_prior_order))` days after their last order. 

In total, there are `r instacart %>% select(aisle) %>% n_distinct()` aisles and the most items are ordered from the `r instacart %>% count(aisle,name="n_aisle") %>% mutate(max_aisle = min_rank(desc(n_aisle))) %>% filter(max_aisle == 1) %>% summarize(aisle)`. 


## Plot of Items Ordered

```{r}
plot_aisles = instacart %>% 
  count(aisle, name = "n_aisle") %>% 
  filter(n_aisle > 10000) %>% 
  arrange(desc(aisle)) %>% 
  mutate(
    aisle = str_to_title(aisle)
  ) %>% 
  ggplot(aes(x = aisle, y = n_aisle)) +
  geom_bar(stat ="identity") + 
  geom_text(aes(label = n_aisle), hjust=-0.05, size = 1.5) +
  labs(
    title = "Number of Items Ordered in Aisles",
    x = "Aisle Name",
    y = "Total Items Ordered",
    caption = "Data from instacart") +
  scale_y_continuous(limits = c(0, 160000)) +
  theme(text = element_text(size=7))
  

plot_aisles + coord_flip()
```

## Most Popular Items in Each Row

```{r}

top3_products = instacart %>% 
  select(aisle, product_name) %>% 
  filter(
    aisle == "baking ingredients" | 
    aisle == "dog food care" | 
    aisle == "packaged vegetables fruits") %>% 
  group_by(aisle) %>% 
  count(product_name, name = "n_product") %>% 
  filter(min_rank(desc(n_product)) < 4) %>% 
  knitr::kable()

top3_products
```


## Pink Ladies and Coffee Ice Cream

```{r}
apples_and_cream = instacart %>% 
  filter(product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream") %>% 
  group_by(order_dow) %>% 
  summarize(mean_hour_ordered = mean(order_hour_of_day)) %>% 
  mutate(day_of_week = recode(order_dow, 
         `0` = "Monday", 
         `1` = "Tuesday", 
         `2` = "Wednesday", 
         `3` = "Thursday",
         `4` = "Friday", 
         `5` = "Saturday",
         `6` = "Sunday")) %>% 
  select(day_of_week, mean_hour_ordered) %>% 
  knitr::kable()

apples_and_cream
```

# Problem 2

```{r}
library(p8105.datasets)
data("brfss_smart2010")

brfss_smart2010 = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health" & response != "Very good") %>% 
  mutate(response_factor = factor(response, ordered = TRUE, levels = c("Poor","Good", "Fair", "Excellent" )))
```

